---
title: "Пульс веб-платформы 10.05.2024"
description: "Новости веб-платформы"
pubDate: "May 10 2024"
heroImage: "/blog-placeholder-pulse.jpg"
tags: ["Пульс_веб_платформы"]
---

### Новости

- [выпущена Node v22.1.0](https://nodejs.org/en/blog/release/v22.1.0): появилась поддержка `NODE_COMPILE_CACHE` для включения режима кеширования V8 (если граф модулей не меняется, то повторная пересборка становится быстрее за счёт кэша)
- только недавно в Next.js решили не патчить `fetch`, как в [React решили патчить Date](https://twitter.com/acdlite/status/1785691330988986587): «мы по-тихому, никому мешать не будем, со стандартами будет совместимо, вы же полифиллы используете, вот и дату норм пропатчить»; вроде так, но есть нюанс: в случае полифиллов добавляются костыли для воссоздания недостающих стандартных возможностей платформы, а фича-патчи добавляют проприетарные костыли, что уже не то же самое

### Проекты

- [react-tracked](https://github.com/dai-shi/react-tracked) — представьте, что у вас есть `useState/useReducer`, которые триггерят ререндеры не всегда, когда стейт перезадался, а когда он именно изменился, стал другим (под капотом Proxy, работает для вложенных уровней стейта тоже)
- [pragmatic-drag-and-drop](https://atlassian.design/components/pragmatic-drag-and-drop/about) — многообещающая либа для драг-н-дропа (для травмированных React DnD)

### Статьи и демки

#### JS

- [почему таки плохо патчить globals](https://kettanaito.com/blog/why-patching-globals-is-harmful): автоматом создаёт техдолг, нестандартные фичи работают непредсказуемо в разных средах, скрывают магию внутри, лочат на вендора и в целом тормозят прогресс в долгую
- Bun может ускорить не только локальную разработку, но и сборку и деплой на CI, так как, [например](https://render.com/blog/hello-bun-deploy-2x-faster-on-github-render), заменяет yarn и Vitest
- (не совсем JS, но это не так важно) как разложить [одно нечитаемое условное выражение](https://testing.googleblog.com/2024/04/isbooleantoolongandcomplex.html) на несколько мелких или же вынести в отдельную функцию
- чтоб не оборачивать `new URL(urlstring)` в `try catch` для [обработки невалидных урлов](https://kilianvalkhof.com/2024/javascript/the-problem-with-new-url-and-how-url-parse-fixes-that/), можно использовать `URL.canParse(urlstring)`, а также скоро можно будет `URL.parse` (начиная с Chrome 126 и Firefox 126)
- React хорош для организации UI-компонентов, но когда речь заходит про дата-фетчинг, то всё что предлагает React из коробки — это выйти в окно; и в этом случае [на помощь приходит React Query](https://ui.dev/why-react-query), который позаботится о кэшировании, оффлайне, восстановлении скролла и тд, чтобы вы спокойно могли с чистой совестью выключить компьютер в конце рабочего дня
- лучший способ гарантировано отправить неблокирующий запрос при закрытии страницы — [на событии visibilitychange выполнить navigator.sendBeacon()](https://webdeveloper.beehiiv.com/p/securely-send-request-closing-tabs)
- возможно для управления версиями Node стоит попробовать [альтернативы nvm](https://pavel-romanov.com/5-node-version-managers-compared-which-is-right-for-you): самой перспективной выглядит Volta, которая не требует доп файлов (конфиг в package.json), кроссплатформенна, автопереключает версию при смене проекта, а заодно может переключать версию yarn

#### CSS

- как-то незаметно в повседневной разработке мы перестали думать про минификацию стилей, тк [эту функцию взяли на себя фреймворки](https://blog.sentry.io/why-dont-we-talk-about-minifying-css/), хотя [олдфаг mode on] раньше было почему-то важно считать сколько десятков килобайт умеет сэкономить твой минификатор [олдфаг mode off]
- [мифы про специфичность](https://www.bram.us/2024/05/05/misconceptions-about-css-specificity/):
  1. специфичность — это не целое число, а набор из трёх чисел a, b, c
  2. добавление атрибута style не добавляет специфичности
  3. !important не добавляет специфичности, а уносит объявление в другой origin
- в мире победившего `color-mix()`-а серые палитры [создаются с помощью полутона](https://css-irl.info/shades-of-grey-with-color-mix/) между чёрным и белым `color-mix(in oklch, black 20%, white)`
- [border-color: transparent — это ок](https://bradfrost.com/blog/post/transparent-borders/), если, например, на hover задавать видимый цвет, чтобы при задании рамки не изменялись размеры элемента
- `:has()` — это не только «родительский» селектор, но и [полноценный условный оператор для элементов интерфейса](https://www.smashingmagazine.com/2024/05/combining-css-has-html-select-conditional-styling/), например, для `<select>` (красим `select` в зависимости от выбранного значения) или же для всего интерфейса (красим весь сайт в зависимости от выбранного значения (сомнительно))
- [субгриды в помощь](https://noahliebman.net/2024/03/making-room-for-long-list-markers-with-subgrid/) для контроля за переполнением дочерних ячеек грида на примере нумерации в упорядоченных списках
- [Popover API для создания тултипов](https://frontendmasters.com/blog/using-the-popover-api-for-html-tooltips/), якорящихся на элемент-триггер (сложно, но возможно)

### Платформа

- разработчики React Aria поделились, как [сделать человеческое выпадающее субменю](https://react-spectrum.adobe.com/blog/creating-a-pointer-friendly-submenu-experience.html), чтобы оно случайно не закрывалось во время движения курсора: строится визуальный треугольник, в рамках которого считается, что подменю не должно быть скрыто + по скорости движения предполагается, куда пользователь собрался двигать курсор
