---
title: "Пульс веб-платформы 02.08.2024"
description: "Новости веб-платформы"
pubDate: "Aug 02 2024"
heroImage: "/blog-placeholder-pulse.jpg"
---

**#Пульс*веб*платформы 02.08.2024**

**Новости**

- [в Node.js начали завозить «нативную поддержку» TS](https://github.com/nodejs/node/pull/53725), пока на уровне вырезания аннотаций типов из кода, то есть enum-ы и другие штуки, которые просто вырезать не получится, пока что не работают ([под капотом работает либа @swc/wasm-typescript](https://github.com/nodejs/amaro))
- [обновился Babel до версии 7.25.0](https://babeljs.io/blog/2024/07/26/7.25.0): как-то Babel всегда воспринимался как инструмент для использование ультрасовременных фич в браузерах; в целом, этот апдейт так же об этом, но что интересно, добавлен плагин для фикса _браузерного_ бага в Safari 16, и тут я задумался, а сколько там возможно интересного скрыто под капотом популярных инструментов типа Vite, которое незаметно что-то фиксит, и всё просто продолжает работать чуть лучше
- [зарелизился Safari 17.6](https://webkit.org/blog/15739/webkit-features-in-safari-17-6/): поддержали ключевое слово safe во флексбоксах justify-content: safe center, завезли багфиксы события `loadeddata` для `<audio>` и `<video>` на загрузке страницы
- [в Google отказались от идеи блокирования 3d-party cookies](https://privacysandbox.com/news/privacy-sandbox-update/), но зато пообещали дать браузерные настройки, где можно будет явно настроить приватность (делать это конечно же никто не будет)

**Проекты**

- [turndown](https://github.com/mixmark-io/turndown) — преобразователь HTML в md для браузера и Node.js
- [vaul](https://github.com/emilkowalski/vaul) — нестилизованный компонент выдвигающейся «шторки» для React
- [react-movable](https://github.com/tajo/react-movable) — ещё одна drag-n-drop либа для React, апишка с первого взгляда простая

**Статьи и демки**

**JS**

- в до-реактовые времена как-то повсеместно была распространена инфа, что `innerHTML` медленный, и что DOM лучше менять пачкой, а не на каждый чих использовать `appendChild`; потом как-то это всё подменилось знаниями о ререндерах в SPA, тем не менее [DOM никуда не делся](https://frontendmasters.com/blog/patterns-for-memory-efficient-dom-manipulation/) и все ранее работавшие приёмы, а так же новые, работают! Например, `AbortController().abort()` может отменить пачкой навешенные event listener-ы, а `WeakMap` и `WeakRef` можно использовать для создания ссылок на DOM-элементы, которые при их удалении, подчищаются и из памяти
- в интеграционных тестах на Playwright часто [используется await page.goto()](https://www.checklyhq.com/blog/why-page-goto-is-slowing-down-your-playwright-test/), которая по умолчанию открывает страницу и ждёт полной загрузки и отрисовки, что обычно избыточно для тестирования того, что, например, нажатие по кнопке вызывает появление модалки; поэтому лучше пользовать `page.goto("/", {waitUntil: "commit"})`
- [тип unknown полезен для типизации](https://michaeluloth.com/programming-types-unknown-why-useful/) неизвестного user-input-а, когда он может быть, а может не быть, поэтому при попытке обращения, к примеру, к методам строки, тип ругнётся и сообщит, что этого метода может и не быть
- в Vercel провели прикладное исследование, как [сейчас JS влияет SEO в Google](https://vercel.com/blog/how-google-handles-javascript-throughout-the-indexing-process): SPA индексируются также, как и статические сайты; JS выполняется, в том числе на «сервере» Next.js, импорты CSS тоже работают; нагруженные JS сайты индексируются также быстро, как ненагруженные, но если рендер требует большего времени и при этом страниц много, то бот будет дольше их обходить
- barrel-файлы (только реэкспортирующие внутренности модуля) [создают дополнительную вычислительную нагрузку](https://tkdodo.eu/blog/please-stop-using-barrel-files) на проект, и если таких файлов много в большом проекте, то с этим что-то нужно дополнительно делать (убирать такие файлы или преобразовывать пути импортов в обход таких файлов)
- затягивая в замыкание «большой» объект, следует помнить, что если к нему будет обращаться функция внутри замыкания, то это [может привести к утечке памяти](https://jakearchibald.com/2024/garbage-collection-and-closures/) (если создаёте замыкание, стоит проверить, что в него попадёт)

**CSS**

- [директива @property](https://moderncss.dev/providing-type-definitions-for-css-with-at-property/), недавно завезённая во все браузеры, позволяет делать типизированные наборы CSS-переменных (например, в рамках дизайн системы), и типы эти будут, если что, стрелять в рантайме в браузере (при желании наверное можно и stylelint-ом отлавливать неправильно заданные типы во время разработки); кроме того, есть интересные варианты, которые _может быть_ были позаимствованы из TS: тип `syntax: "blue | cyan | dodgerblue"` для задания в переменную только этих цветов или же тип `syntax: <image>#` для задания множественных значений через запятую (также есть тип `'*'` — аналог `any`, тип по умолчанию)
- если вдруг PopopevAPI (с недавнего времени доступный во всех современных браузерах) прошёл мимо вас, то вот [свежий гайд в тему](https://www.amitmerchant.com/popover-api-101/) (годится для создания простых модалок)
